<h1><%= @learning_path.skill.name %> Learning Path</h1>

<div class="container">
  <p class="lead"><%= @learning_path.skill.description %></p>

  <!-- Roadmap Section -->
  <div class="roadmap-section mt-5">
    <h3 class="text-center mb-4">Your Learning Journey</h3>

    <% if @milestones.any? %>
      <!-- Progress Bar -->
      <div class="milestone-progress">
        <progress value="<%= @completed_count %>" max="<%= @milestones.count %>"></progress>
        <p class="progress-text">
          <%= @completed_count %> of <%= @milestones.count %> milestones completed
          (<%= number_to_percentage(@completion_percentage, precision: 1) %>)
        </p>
      </div>
    <% end %>
  </div>

  <!-- Milestone List -->
  <div class="milestones-container">
    <% if @milestones.any? %>
      <% @milestones.each do |milestone| %>
        <div class="milestone-card <%= 'completed' if milestone.completed? %>">
          <h3><%= milestone.title %></h3>
          <p><%= milestone.description %></p>

          <% if milestone.completed? %>
            <span class="badge bg-success">Completed</span>
          <% else %>
            <%= button_to "Mark Complete",
                          mark_complete_learning_path_milestone_path(@learning_path, milestone),
                          method: :patch,
                          class: "btn btn-sm btn-success" %>
          <% end %>
        </div>
      <% end %>
    <% else %>
      <div class="generating-message text-center py-5">
        <%= render 'shared/loading_spinner' %>
        <p class="mt-3">AI is crafting your personalized learning path...</p>
      </div>
    <% end %>
  </div>
</div>
